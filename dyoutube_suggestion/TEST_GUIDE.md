# dyoutube ν…μ¤νΈ κ°€μ΄λ“

YouTube κ²€μƒ‰ κ²°κ³Ό μ¤ν¬λν•‘ API ν…μ¤νΈ λ°©λ²•μ„ μ•λ‚΄ν•©λ‹λ‹¤.

## π“‹ ν…μ¤νΈ μ¤ν¬λ¦½νΈ λ©λ΅

### 1. `run_local.sh` - λ΅μ»¬ μ„λ²„ μ‹¤ν–‰
κ°€μƒν™κ²½μ„ μ„¤μ •ν•κ³  GunicornμΌλ΅ μ„λ²„λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

```bash
./run_local.sh
```

**κΈ°λ¥:**
- Python κ°€μƒν™κ²½ μλ™ μƒμ„±/ν™μ„±ν™”
- μμ΅΄μ„± μλ™ μ„¤μΉ
- Chrome μ„¤μΉ ν™•μΈ
- Gunicorn + Uvicorn workersλ΅ μ„λ²„ μ‹¤ν–‰ (ν¬νΈ 8000)

**μ‹¤ν–‰ ν›„ μ ‘μ†:**
- http://localhost:8000/ - API μ •λ³΄
- http://localhost:8000/health - ν—¬μ¤μ²΄ν¬
- http://localhost:8000/stats - λ“λΌμ΄λ²„ ν’€ ν†µκ³„
- http://localhost:8000/test - κ°„λ‹¨ν• ν…μ¤νΈ

---

### 2. `test_simple.sh` - λΉ λ¥Έ ν…μ¤νΈ
μ„λ²„κ°€ μ •μƒ λ™μ‘ν•λ”μ§€ λΉ λ¥΄κ² ν™•μΈν•©λ‹λ‹¤.

```bash
# λ‹¤λ¥Έ ν„°λ―Έλ„μ—μ„ μ‹¤ν–‰
./test_simple.sh
```

**ν…μ¤νΈ ν•­λ©:**
- β… μ„λ²„ ν—¬μ¤μ²΄ν¬
- β… ν…μ¤νΈ μ—”λ“ν¬μΈνΈ
- β… YouTube κ²€μƒ‰ (3κ° κ²°κ³Ό)

**μμƒ μ†μ” μ‹κ°„:** μ•½ 10-20μ΄

---

### 3. `test_local.sh` - μΆ…ν•© ν…μ¤νΈ
λ¨λ“  κΈ°λ¥μ„ μƒμ„Έν ν…μ¤νΈν•κ³  μ„±λ¥μ„ μΈ΅μ •ν•©λ‹λ‹¤.

```bash
# λ‹¤λ¥Έ ν„°λ―Έλ„μ—μ„ μ‹¤ν–‰
./test_local.sh
```

**ν…μ¤νΈ ν•­λ©:**
- π“ λ£¨νΈ μ—”λ“ν¬μΈνΈ
- π’ ν—¬μ¤μ²΄ν¬
- π“ λ“λΌμ΄λ²„ ν’€ μ΄κΈ° ν†µκ³„
- π¬ YouTube κ²€μƒ‰ (μ²« μ”μ²­ - λ“λΌμ΄λ²„ μƒμ„±)
- β΅ YouTube κ²€μƒ‰ (λ‘ λ²μ§Έ μ”μ²­ - λ“λΌμ΄λ²„ μ¬μ‚¬μ©)
- β΅ YouTube κ²€μƒ‰ (μ„Έ λ²μ§Έ μ”μ²­ - λ“λΌμ΄λ²„ μ¬μ‚¬μ©)
- π μμ–΄ ν‚¤μ›λ“ ν…μ¤νΈ
- π‡°π‡· ν•κΈ€+μμ–΄ νΌν•© ν…μ¤νΈ
- ποΈ Shorts ν‚¤μ›λ“ ν…μ¤νΈ
- π“ μµμΆ… ν†µκ³„

**νΉμ§•:**
- `time` λ…λ Ήμ–΄λ΅ μ‘λ‹µ μ‹κ°„ μΈ΅μ •
- λ“λΌμ΄λ²„ ν’€λ§ ν¨κ³Ό ν™•μΈ κ°€λ¥
- μ²« μ”μ²­ vs μ΄ν›„ μ”μ²­ μ†λ„ λΉ„κµ

**μμƒ μ†μ” μ‹κ°„:** μ•½ 1-2λ¶„

---

### 4. `test_error.sh` - μ—λ¬ μ²λ¦¬ ν…μ¤νΈ
λ‹¤μ–‘ν• μ—λ¬ μΌ€μ΄μ¤λ¥Ό ν…μ¤νΈν•©λ‹λ‹¤.

```bash
# λ‹¤λ¥Έ ν„°λ―Έλ„μ—μ„ μ‹¤ν–‰
./test_error.sh
```

**ν…μ¤νΈ ν•­λ©:**
- β λΉ ν‚¤μ›λ“ (400 μ—λ¬)
- β μμ limit (400 μ—λ¬)
- β limit=0 (400 μ—λ¬)
- β μ΅΄μ¬ν•μ§€ μ•λ” μ—”λ“ν¬μΈνΈ (404 μ—λ¬)
- β… νΉμλ¬Έμ ν‚¤μ›λ“ (μ •μƒ μ²λ¦¬)
- β… λ§¤μ° κΈ΄ ν‚¤μ›λ“ (μ •μƒ μ²λ¦¬)
- β κ³µλ°±λ§ μλ” ν‚¤μ›λ“ (400 μ—λ¬)

**μμƒ μ†μ” μ‹κ°„:** μ•½ 30-60μ΄

---

## π€ λΉ λ¥Έ μ‹μ‘

### 1λ‹¨κ³„: μ„λ²„ μ‹¤ν–‰
```bash
cd /Users/user/workspace/private/crawlcrawl/dyoutube
./run_local.sh
```

### 2λ‹¨κ³„: ν…μ¤νΈ μ‹¤ν–‰ (μƒ ν„°λ―Έλ„)
```bash
cd /Users/user/workspace/private/crawlcrawl/dyoutube

# λΉ λ¥Έ ν…μ¤νΈ
./test_simple.sh

# λλ” μΆ…ν•© ν…μ¤νΈ
./test_local.sh

# λλ” μ—λ¬ μ²λ¦¬ ν…μ¤νΈ
./test_error.sh
```

---

## π“ API μ—”λ“ν¬μΈνΈ

### GET `/`
API μ •λ³΄ λ° μ‚¬μ© κ°€λ¥ν• μ—”λ“ν¬μΈνΈ λ©λ΅

**μ‘λ‹µ:**
```json
{
  "service": "YouTube Scraper API",
  "version": "2.0.0",
  "endpoints": {...},
  "features": [...],
  "performance": {...}
}
```

### GET `/health`
μ„λ²„ μƒνƒ ν™•μΈ

**μ‘λ‹µ:**
```json
{
  "status": "healthy",
  "service": "dyoutube_scraper",
  "version": "2.0.0",
  "note": "Using Selenium driver pool for better performance"
}
```

### GET `/stats`
λ“λΌμ΄λ²„ ν’€ μ‚¬μ© ν†µκ³„

**μ‘λ‹µ:**
```json
{
  "driver_pool_stats": {
    "total_requests": 10,
    "driver_restarts": 1,
    "driver_errors": 0
  },
  "description": {...}
}
```

### GET `/test`
κ°„λ‹¨ν• ν…μ¤νΈ μ—”λ“ν¬μΈνΈ

**μ‘λ‹µ:**
```json
{
  "result": "test success"
}
```

### GET `/search/list`
YouTube κ²€μƒ‰ κ²°κ³Ό μ¤ν¬λν•‘

**νλΌλ―Έν„°:**
- `keywords` (ν•„μ): κ²€μƒ‰ ν‚¤μ›λ“
- `limit` (μ„ νƒ, κΈ°λ³Έκ°’: 20): κ²€μƒ‰ κ²°κ³Ό κ°μ

**μμ‹:**
```bash
curl "http://localhost:8000/search/list?keywords=νμ΄μ¬&limit=5"
```

**μ‘λ‹µ:**
```json
{
  "keyword": "νμ΄μ¬",
  "result": [
    {
      "VideoID": "abc123",
      "title": "νμ΄μ¬ κΈ°μ΄ κ°•μ",
      "channel": "μ½”λ”©μ±„λ„",
      "url": "https://www.youtube.com/watch?v=abc123",
      "description": "νμ΄μ¬ κΈ°μ΄λ¶€ν„° μ‹μ‘ν•λ”...",
      "publishedDate": "2024-01-15",
      "videoCount": "150000",
      "videoType": "video"
    },
    ...
  ]
}
```

---

## π”§ μ„±λ¥ νΉμ§•

### λ“λΌμ΄λ²„ ν’€λ§
- **μ²« μ”μ²­**: 5-10μ΄ (Chrome λ“λΌμ΄λ²„ μƒμ„± ν¬ν•¨)
- **μ΄ν›„ μ”μ²­**: λ” λΉ λ¥Έ μ‘λ‹µ (λ“λΌμ΄λ²„ μ¬μ‚¬μ©)
- **μλ™ μ¬μ‹μ‘**: 100κ° μ”μ²­λ§λ‹¤ λ©”λ¨λ¦¬ λ„μ λ°©μ§€

### Gunicorn μ„¤μ •
- **μ›μ»¤ μ**: 2κ° (ν™κ²½λ³€μλ΅ μ΅°μ • κ°€λ¥)
- **μ›μ»¤ ν΄λμ¤**: uvicorn.workers.UvicornWorker
- **νƒ€μ„μ•„μ›ƒ**: 120μ΄ (Selenium μ‘μ—… λ€μ‘)
- **μλ™ μ¬μ‹μ‘**: 1000 μ”μ²­λ§λ‹¤ μ›μ»¤ μ¬μ‹μ‘

---

## π› λ¬Έμ  ν•΄κ²°

### Chrome λ“λΌμ΄λ²„ μ—λ¬
Chromeμ΄ μ„¤μΉλμ–΄ μλ”μ§€ ν™•μΈν•μ„Έμ”:
```bash
ls "/Applications/Google Chrome.app"
```

### ν¬νΈ μ¶©λ
ν¬νΈ 8000μ΄ μ΄λ―Έ μ‚¬μ© μ¤‘μΈ κ²½μ°:
```bash
lsof -ti:8000 | xargs kill -9
```

### κ°€μƒν™κ²½ λ¬Έμ 
κ°€μƒν™κ²½μ„ μ‚­μ ν•κ³  λ‹¤μ‹ μƒμ„±:
```bash
rm -rf venv
./run_local.sh
```

---

## π“ μ¶”κ°€ μ •λ³΄

### μμ΅΄μ„±
- Python 3.8+
- Chrome λΈλΌμ°μ €
- ν•„μ”ν• ν¨ν‚¤μ§€λ” `requirements.txt` μ°Έμ΅°

### λ΅κ·Έ ν™•μΈ
μ„λ²„ μ‹¤ν–‰ μ‹ λ¨λ“  λ΅κ·Έκ°€ μ½μ†”μ— μ¶λ ¥λ©λ‹λ‹¤:
- μ”μ²­/μ‘λ‹µ μ •λ³΄
- λ“λΌμ΄λ²„ ν’€ μƒνƒ
- μ—λ¬ μ •λ³΄

### ν†µκ³„ λ¨λ‹ν„°λ§
`/stats` μ—”λ“ν¬μΈνΈλ΅ μ‹¤μ‹κ°„ ν†µκ³„ ν™•μΈ:
```bash
watch -n 1 'curl -s http://localhost:8000/stats | jq'
```

---

## π’΅ ν

1. **μ²« μ”μ²­μ΄ λλ¦°κ°€μ”?**
   - μ •μƒμ…λ‹λ‹¤! Chrome λ“λΌμ΄λ²„λ¥Ό μƒμ„±ν•λ” μ‹κ°„μ΄ ν•„μ”ν•©λ‹λ‹¤.
   - λ‘ λ²μ§Έ μ”μ²­λ¶€ν„°λ” ν›¨μ”¬ λΉ¨λΌμ§‘λ‹λ‹¤.

2. **μ„±λ¥ λΉ„κµν•κΈ°**
   - `test_local.sh`λ¥Ό μ‹¤ν–‰ν•λ©΄ μ²« μ”μ²­κ³Ό μ΄ν›„ μ”μ²­μ μ†λ„ μ°¨μ΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

3. **μ—λ¬ μ²λ¦¬ ν™•μΈν•κΈ°**
   - `test_error.sh`λ΅ λ‹¤μ–‘ν• μ—λ¬ μΌ€μ΄μ¤κ°€ μ¬λ°”λ¥΄κ² μ²λ¦¬λλ”μ§€ ν™•μΈν•μ„Έμ”.

4. **μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§**
   - `/stats` μ—”λ“ν¬μΈνΈλ¥Ό μ£ΌκΈ°μ μΌλ΅ νΈμ¶ν•μ—¬ λ“λΌμ΄λ²„ ν’€ μƒνƒλ¥Ό λ¨λ‹ν„°λ§ν•μ„Έμ”.

